
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Exneyder A. Montoya-Araque">
      
      
      
        <link rel="prev" href="../tutorials/01_dummy_example/">
      
      
        <link rel="next" href="../history/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Package docstrings - pyNewmarkDisp Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#package-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyNewmarkDisp Docs" class="md-header__button md-logo" aria-label="pyNewmarkDisp Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyNewmarkDisp Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Package docstrings
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/eamontoyaa/pyNewmarkDisp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyNewmarkDisp Docs" class="md-nav__button md-logo" aria-label="pyNewmarkDisp Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    pyNewmarkDisp Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eamontoyaa/pyNewmarkDisp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Illustrative examples and tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Illustrative examples and tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/01_dummy_example/" class="md-nav__link">
        Dummy example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Package docstrings
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Package docstrings
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark" class="md-nav__link">
    newmark
  </a>
  
    <nav class="md-nav" aria-label="newmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.direct_newmark" class="md-nav__link">
    direct_newmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.empirical_correlations" class="md-nav__link">
    empirical_correlations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.first_newmark_integration" class="md-nav__link">
    first_newmark_integration()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.plot_newmark_integration" class="md-nav__link">
    plot_newmark_integration()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.trapz" class="md-nav__link">
    trapz()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial" class="md-nav__link">
    spatial
  </a>
  
    <nav class="md-nav" aria-label="spatial">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_dip_azimuth" class="md-nav__link">
    get_dip_azimuth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_hillshade" class="md-nav__link">
    get_hillshade()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_idx_at_coords" class="md-nav__link">
    get_idx_at_coords()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_slope" class="md-nav__link">
    get_slope()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.hzt_accel_from_2_dir" class="md-nav__link">
    hzt_accel_from_2_dir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.load_ascii_raster" class="md-nav__link">
    load_ascii_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.map_zones" class="md-nav__link">
    map_zones()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.plot_spatial_field" class="md-nav__link">
    plot_spatial_field()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.reclass_raster" class="md-nav__link">
    reclass_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.spatial_hzt_accel_from_2_dir" class="md-nav__link">
    spatial_hzt_accel_from_2_dir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.spatial_newmark" class="md-nav__link">
    spatial_newmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.verify_newmark_at_cell" class="md-nav__link">
    verify_newmark_at_cell()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope" class="md-nav__link">
    infslope
  </a>
  
    <nav class="md-nav" aria-label="infslope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.factor_of_safety" class="md-nav__link">
    factor_of_safety()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.get_ky" class="md-nav__link">
    get_ky()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.min_fs_and_depth" class="md-nav__link">
    min_fs_and_depth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.num_to_2darray" class="md-nav__link">
    num_to_2darray()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr" class="md-nav__link">
    empir_corr
  </a>
  
    <nav class="md-nav" aria-label="empir_corr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.ambraseys_and_menu_88" class="md-nav__link">
    ambraseys_and_menu_88()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.bray_and_travasarou_07_eq6" class="md-nav__link">
    bray_and_travasarou_07_eq6()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_mean" class="md-nav__link">
    hynesgriffin_and_Franklin_1984_mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_ub" class="md-nav__link">
    hynesgriffin_and_Franklin_1984_ub()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq10" class="md-nav__link">
    jibson_07_eq10()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq6" class="md-nav__link">
    jibson_07_eq6()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq9" class="md-nav__link">
    jibson_07_eq9()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq5" class="md-nav__link">
    saygili_and_rathje_08_eq5()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col2" class="md-nav__link">
    saygili_and_rathje_08_eq6col2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col4" class="md-nav__link">
    saygili_and_rathje_08_eq6col4()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        History
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark" class="md-nav__link">
    newmark
  </a>
  
    <nav class="md-nav" aria-label="newmark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.direct_newmark" class="md-nav__link">
    direct_newmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.empirical_correlations" class="md-nav__link">
    empirical_correlations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.first_newmark_integration" class="md-nav__link">
    first_newmark_integration()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.plot_newmark_integration" class="md-nav__link">
    plot_newmark_integration()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.newmark.trapz" class="md-nav__link">
    trapz()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial" class="md-nav__link">
    spatial
  </a>
  
    <nav class="md-nav" aria-label="spatial">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_dip_azimuth" class="md-nav__link">
    get_dip_azimuth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_hillshade" class="md-nav__link">
    get_hillshade()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_idx_at_coords" class="md-nav__link">
    get_idx_at_coords()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.get_slope" class="md-nav__link">
    get_slope()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.hzt_accel_from_2_dir" class="md-nav__link">
    hzt_accel_from_2_dir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.load_ascii_raster" class="md-nav__link">
    load_ascii_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.map_zones" class="md-nav__link">
    map_zones()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.plot_spatial_field" class="md-nav__link">
    plot_spatial_field()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.reclass_raster" class="md-nav__link">
    reclass_raster()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.spatial_hzt_accel_from_2_dir" class="md-nav__link">
    spatial_hzt_accel_from_2_dir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.spatial_newmark" class="md-nav__link">
    spatial_newmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.spatial.verify_newmark_at_cell" class="md-nav__link">
    verify_newmark_at_cell()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope" class="md-nav__link">
    infslope
  </a>
  
    <nav class="md-nav" aria-label="infslope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.factor_of_safety" class="md-nav__link">
    factor_of_safety()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.get_ky" class="md-nav__link">
    get_ky()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.min_fs_and_depth" class="md-nav__link">
    min_fs_and_depth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.infslope.num_to_2darray" class="md-nav__link">
    num_to_2darray()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr" class="md-nav__link">
    empir_corr
  </a>
  
    <nav class="md-nav" aria-label="empir_corr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.ambraseys_and_menu_88" class="md-nav__link">
    ambraseys_and_menu_88()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.bray_and_travasarou_07_eq6" class="md-nav__link">
    bray_and_travasarou_07_eq6()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_mean" class="md-nav__link">
    hynesgriffin_and_Franklin_1984_mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_ub" class="md-nav__link">
    hynesgriffin_and_Franklin_1984_ub()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq10" class="md-nav__link">
    jibson_07_eq10()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq6" class="md-nav__link">
    jibson_07_eq6()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.jibson_07_eq9" class="md-nav__link">
    jibson_07_eq9()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq5" class="md-nav__link">
    saygili_and_rathje_08_eq5()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col2" class="md-nav__link">
    saygili_and_rathje_08_eq6col2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col4" class="md-nav__link">
    saygili_and_rathje_08_eq6col4()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="package-structure">Package structure</h1>
<p>All the modules and functions are documented in the following sections.</p>


<div class="doc doc-object doc-module">



<h2 id="pynewmarkdisp.newmark" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">pynewmarkdisp.newmark</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Functions to calculate permanent displacements using empirical correlations.</p>
<p>Permanent displacements are calculated based on the
<a href="https://doi.org/10.1680/geot.1965.15.2.139">Newmark (1965)</a> sliding block
method.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.newmark.direct_newmark" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">direct_newmark</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">direct_newmark</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the permanent displacements using the direct Newmark method.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>(n,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the time series of the earthquake record, in [s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel</code></td>
          <td>
                <code>(n,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series of the earthquake record.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ky</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical seismic coefficient (yield coefficient).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>g</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Acceleration of gravity, in the same units as <code>accel</code>. For example,
if <code>accel</code> is in [m/s²], <code>g</code> should be equal to 9.81; if <code>accel</code>
is as a fraction of gravity, <code>g</code> should be equal to 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>newmark_str</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the structure from the Newmark's method. The structure
includes time, acceleration, velocity, and displacements series, as
well as the critical seismic coefficient and accelerarion, and the
permanent displacement calculated (in meters).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/newmark.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="k">def</span> <span class="nf">direct_newmark</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    Calculate the permanent displacements using the direct Newmark method.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    time : (n,) ndarray</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        1D array with the time series of the earthquake record, in [s].</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    accel : (n,) ndarray</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        1D array with the acceleration series of the earthquake record.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    ky : float</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        Critical seismic coefficient (yield coefficient).</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    g : float</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        Acceleration of gravity, in the same units as ``accel``. For example,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        if ``accel`` is in [m/s²], ``g`` should be equal to 9.81; if ``accel``</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        is as a fraction of gravity, ``g`` should be equal to 1.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    -------</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    newmark_str : dict</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        Dictionary with the structure from the Newmark&#39;s method. The structure</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        includes time, acceleration, velocity, and displacements series, as</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        well as the critical seismic coefficient and accelerarion, and the</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        permanent displacement calculated (in meters).</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">ay</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="o">*</span> <span class="n">ky</span>  <span class="c1"># Yield acceleration to SI units</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">accel</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="o">*</span> <span class="n">accel</span> <span class="o">/</span> <span class="n">g</span>  <span class="c1"># Earthquake acceleration to SI units</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">ay</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">ay</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="p">):</span>  <span class="c1"># The slope is already unstable under static condition</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">elif</span> <span class="n">accel</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">ay</span><span class="p">:</span>  <span class="c1"># Evaluate only if the earthquake exceeds `ay`</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="c1"># Velocity</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">vel</span> <span class="o">=</span> <span class="n">first_newmark_integration</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ay</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="c1"># Displacement</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">disp</span> <span class="o">=</span> <span class="n">cumul_integral</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">vel</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># The slope is stable even under seudostatic condition</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">accel</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">accel</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="s2">&quot;accel&quot;</span><span class="p">:</span> <span class="n">accel</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="s2">&quot;vel&quot;</span><span class="p">:</span> <span class="n">vel</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="s2">&quot;disp&quot;</span><span class="p">:</span> <span class="n">disp</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="s2">&quot;ky&quot;</span><span class="p">:</span> <span class="n">ky</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="s2">&quot;ay&quot;</span><span class="p">:</span> <span class="n">ay</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="s2">&quot;perm_disp&quot;</span><span class="p">:</span> <span class="n">disp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.newmark.empirical_correlations" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">empirical_correlations</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">empirical_correlations</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Run a function of an empirical correlation for uₚ calculation.</p>
<p>It is possible to call a function from the <code>empir_corr.py</code> module by
passing the ID of the function to the <code>opt</code> keyword argument, or by
passing the function itself to the <code>correlation_funct</code> keyword argument.</p>
<p>The <code>opt</code> keyword argument follows the numbering of the functions in the
Table 1 of <a href="https://doi.org/10.1016/j.enggeo.2012.10.016">Meehan &amp; Vahedifard (2013)</a>
(see the <code>empir_corr.py</code> module for more details).</p>
<p>After choosing either <code>opt</code> or <code>correlation_funct</code>, the remaining
keyword arguments are passed to the chosen function.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement calculated by the chosen function using an
empirical correlation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/newmark.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="k">def</span> <span class="nf">empirical_correlations</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a function of an empirical correlation for uₚ calculation.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    It is possible to call a function from the ``empir_corr.py`` module by</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    passing the ID of the function to the ``opt`` keyword argument, or by</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    passing the function itself to the ``correlation_funct`` keyword argument.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    The ``opt`` keyword argument follows the numbering of the functions in the</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Table 1 of [Meehan &amp; Vahedifard (2013)](https://doi.org/10.1016/j.enggeo.2012.10.016)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    (see the ``empir_corr.py`` module for more details).</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    After choosing either ``opt`` or ``correlation_funct``, the remaining</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    keyword arguments are passed to the chosen function.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    -------</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Permanent displacement calculated by the chosen function using an</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        empirical correlation.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="s2">&quot;opt&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">correlation_funct</span> <span class="o">=</span> <span class="n">correlations</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;opt&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">correlation_funct</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;correlation_funct&quot;</span><span class="p">]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">return</span> <span class="n">correlation_funct</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.newmark.first_newmark_integration" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">first_newmark_integration</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">first_newmark_integration</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ay</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Perform the first integration of the Newmark method.</p>
<p>The integration is performed using the trapezoidal rule. It accounts for
energy dissipation at each peak above the critical acceleration by
subtracting the area between $y=a_y$ and $y=a(t)$ after the peak until the
velocity is zero.</p>
<p>This funtion is optimized for speed using Numba.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the time series of the earthquake record, in units
consistent with <code>accel</code> and <code>ay</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel</code></td>
          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series of the earthquake record, in the
same units as <code>ay</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in the same units as <code>accel</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>vel</code></td>          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the velocity series obtained by the first integration of
the Newmark method. Units are consistent with <code>accel</code> and <code>ay</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/newmark.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="nd">@njit</span><span class="p">(</span><span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span> <span class="nf">first_newmark_integration</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ay</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform the first integration of the Newmark method.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    The integration is performed using the trapezoidal rule. It accounts for</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    energy dissipation at each peak above the critical acceleration by</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    subtracting the area between $y=a_y$ and $y=a(t)$ after the peak until the</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    velocity is zero.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    This funtion is optimized for speed using Numba.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    time : (n, ) ndarray</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        1D array with the time series of the earthquake record, in units</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        consistent with ``accel`` and ``ay``.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    accel : (n, ) ndarray</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        1D array with the acceleration series of the earthquake record, in the</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        same units as ``ay``.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    ay : int or float</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        Critical acceleration, in the same units as ``accel``.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    -------</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    vel : (n, ) ndarray</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        1D array with the velocity series obtained by the first integration of</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        the Newmark method. Units are consistent with ``accel`` and ``ay``.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">if</span> <span class="n">accel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ay</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">vel</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">trapz</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="n">y</span><span class="o">=</span><span class="n">accel</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ay</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">elif</span> <span class="n">accel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ay</span> <span class="ow">and</span> <span class="n">vel</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">vel</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                <span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">accel</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">vel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">return</span> <span class="n">vel</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.newmark.plot_newmark_integration" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">plot_newmark_integration</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">plot_newmark_integration</span><span class="p">(</span><span class="n">newmark_str</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Plot the double-integration procedure of the direct Newmark method.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>newmark_str</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the structure from the Newmark's method. The structure
includes time, acceleration, velocity, and displacements series, as
well as the critical seismic coefficient and accelerarion, and the
permanent displacement calculated (in meters). This dictionary is
returned by the <code>direct_newmark</code> function.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>compressed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the plot will be compressed in a single row. Otherwise,
the plot will be in three rows. Default is <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fig</code></td>          <td>
                <code>matplotlib.<span title="matplotlib.figure">figure</span>.<span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matplotlib object which might be used to save the figure as a file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/newmark.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="k">def</span> <span class="nf">plot_newmark_integration</span><span class="p">(</span><span class="n">newmark_str</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Plot the double-integration procedure of the direct Newmark method.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    newmark_str : dict</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Dictionary with the structure from the Newmark&#39;s method. The structure</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        includes time, acceleration, velocity, and displacements series, as</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        well as the critical seismic coefficient and accelerarion, and the</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        permanent displacement calculated (in meters). This dictionary is</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        returned by the ``direct_newmark`` function.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    compressed : bool, optional</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        If ``True``, the plot will be compressed in a single row. Otherwise,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        the plot will be in three rows. Default is ``False``.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    -------</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    fig : matplotlib.figure.Figure</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Matplotlib object which might be used to save the figure as a file.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">if</span> <span class="n">compressed</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">ax1</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#997700&quot;</span><span class="p">,</span> <span class="s2">&quot;#BB5566&quot;</span><span class="p">,</span> <span class="s2">&quot;#004488&quot;</span><span class="p">]</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#004488&quot;</span><span class="p">,</span> <span class="s2">&quot;#004488&quot;</span><span class="p">,</span> <span class="s2">&quot;#004488&quot;</span><span class="p">]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1"># Acceleration</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;accel&quot;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">ay</span> <span class="o">=</span> <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;ay&quot;</span><span class="p">]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">ky</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="mf">9.81</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">l1</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">ay</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$a_</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{y}</span><span class="s2">=$&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ky</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">g&quot;</span><span class="p">,</span>  <span class="c1"># = &quot; + f&quot;{ay:.2f} m/s$^2$&quot;,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Acceleration, $a$ [m s$^{- 2}$]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Velocity</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;vel&quot;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Velocity, $v$ [m s$^{- 1}$]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># Displacement</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="k">if</span> <span class="n">compressed</span> <span class="k">else</span> <span class="mf">1.0</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;disp&quot;</span><span class="p">],</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="p">(</span><span class="n">p1</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;disp&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">mfc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$u_</span><span class="se">\\</span><span class="s2">mathrm</span><span class="si">{p}</span><span class="s2">=$&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">newmark_str</span><span class="p">[</span><span class="s1">&#39;disp&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Displacement, $u$ [m]&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time, $t$ [s]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># Setup</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">color_lbl</span> <span class="o">=</span> <span class="n">color</span> <span class="k">if</span> <span class="n">compressed</span> <span class="k">else</span> <span class="s2">&quot;k&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color_lbl</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">color_lbl</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">if</span> <span class="n">compressed</span><span class="p">:</span>  <span class="c1"># Adjust the position of the axis and its label</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Make the spine visible</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s2">&quot;outward&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>  <span class="c1"># Position the ticks on the left</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">ax0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">l1</span><span class="p">,</span> <span class="n">p1</span><span class="p">],</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time, $t$ [s]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.newmark.trapz" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">trapz</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the area under de curve y=f(x) by the trapezoidal rule method.</p>
<p>This funtion is optimized for speed using Numba.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the values of the function y=f(x).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the values of the independent variable x.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>area</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Area under the curve y=f(x) calculated by the trapezoidal rule method.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/newmark.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="nd">@njit</span><span class="p">(</span><span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span> <span class="nf">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area under de curve y=f(x) by the trapezoidal rule method.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    This funtion is optimized for speed using Numba.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    y : (n, ) ndarray</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        1D array with the values of the function y=f(x).</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    x : (n, ) ndarray</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        1D array with the values of the independent variable x.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    -------</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    area : float</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        Area under the curve y=f(x) calculated by the trapezoidal rule method.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="pynewmarkdisp.spatial" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">pynewmarkdisp.spatial</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Functions to calculate permanent displacements in a spatial domain.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.get_dip_azimuth" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_dip_azimuth</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_dip_azimuth</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the azimuth of the slope dip direction from the North.</p>
<p>Positive values are clockwise from the North. The azimuth is returned in
[°], ranging from 0 to 360.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dem</code></td>
          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the digital elevation model (DEM) of the area.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cellsize</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cell size of the raster representing the DEM. Its default value is 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>azimuth</code></td>          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spatial distribution of the azimuth of the slope dip direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="k">def</span> <span class="nf">get_dip_azimuth</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the azimuth of the slope dip direction from the North.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Positive values are clockwise from the North. The azimuth is returned in</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    [°], ranging from 0 to 360.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    dem : (m, n) array</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        2D array with the digital elevation model (DEM) of the area.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    cellsize : int, optional</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        Cell size of the raster representing the DEM. Its default value is 1.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">    -------</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    azimuth : (m, n) array</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        Spatial distribution of the azimuth of the slope dip direction.</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="n">dzdy</span><span class="p">,</span> <span class="n">dzdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="n">dzdx</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Adequate sign for the x component</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dzdy</span><span class="p">,</span> <span class="n">dzdx</span><span class="p">))</span> <span class="o">%</span> <span class="mi">360</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.get_hillshade" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_hillshade</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_hillshade</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">sun_azimuth</span><span class="o">=</span><span class="mi">315</span><span class="p">,</span> <span class="n">sun_altitude</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Generate a hillshade image from the DEM.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dem</code></td>
          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the digital elevation model (DEM) of the area</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sun_azimuth</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Azimuth of the sun, in [°]. Its default value is 315.</p>
            </div>
          </td>
          <td>
                <code>315</code>
          </td>
        </tr>
        <tr>
          <td><code>sun_altitude</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Angle from the horizontal plane to the sun, in degrees, indicating the
altitude of the sun. Its default value is 30.</p>
            </div>
          </td>
          <td>
                <code>30</code>
          </td>
        </tr>
        <tr>
          <td><code>cellsize</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cell size of the raster representing the DEM. Units must be consistent
with the units of <code>dem</code>. Its default value is 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>hillshade</code></td>          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the hillshade raster.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="k">def</span> <span class="nf">get_hillshade</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">sun_azimuth</span><span class="o">=</span><span class="mi">315</span><span class="p">,</span> <span class="n">sun_altitude</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a hillshade image from the DEM.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    dem : (m, n) array</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        2D array with the digital elevation model (DEM) of the area</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    sun_azimuth : int or float, optional</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        Azimuth of the sun, in [°]. Its default value is 315.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    sun_altitude : int or float, optional</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        Angle from the horizontal plane to the sun, in degrees, indicating the</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        altitude of the sun. Its default value is 30.</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    cellsize : int, optional</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        Cell size of the raster representing the DEM. Units must be consistent</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        with the units of ``dem``. Its default value is 1.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    -------</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    hillshade : (m, n) array</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        2D array with the hillshade raster.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">sun_azimuth_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">sun_azimuth</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">sun_altitude_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">sun_altitude</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">slope_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">get_slope</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">))</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">azimuth_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">get_dip_azimuth</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">))</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="c1"># Lambertian reflectance</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth_r</span> <span class="o">-</span> <span class="n">sun_azimuth_r</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope_r</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">sun_altitude_r</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope_r</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">sun_altitude_r</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">reflectance</span> <span class="o">=</span> <span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">ptp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">reflectance</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">reflectance</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="k">return</span> <span class="mi">255</span> <span class="o">*</span> <span class="p">(</span><span class="n">reflectance</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">reflectance</span><span class="p">))</span> <span class="o">/</span> <span class="n">ptp</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.get_idx_at_coords" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_idx_at_coords</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_idx_at_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">spat_ref</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Convert coordinates to array indexes.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Coordinate in the x-direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Coordinate in the y-direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>spat_ref</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the spatial reference of the raster. It contains the
same information of the ASCII file header. See the documentation of
the <code>read_ascii</code> function for more information.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>indexes</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple with the indexes of the array corresponding to the given
coordinates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="k">def</span> <span class="nf">get_idx_at_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">spat_ref</span><span class="p">):</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert coordinates to array indexes.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    x : int or float</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Coordinate in the x-direction.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    y : int or float</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        Coordinate in the y-direction.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    spat_ref : dict</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        Dictionary with the spatial reference of the raster. It contains the</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        same information of the ASCII file header. See the documentation of</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        the ``read_ascii`` function for more information.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    -------</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    indexes : tuple</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Tuple with the indexes of the array corresponding to the given</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        coordinates.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;nrows&quot;</span><span class="p">]</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;yllcorner&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;cellsize&quot;</span><span class="p">])</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;xllcorner&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;cellsize&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.get_slope" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_slope</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_slope</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the slope (or inclination) of the terrain.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dem</code></td>
          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the digital elevation model (DEM) of the area.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cellsize</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cell size of the raster representing the DEM. Units must be consistent
with the units of <code>dem</code>. Its default value is 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>slope</code></td>          <td>
                <code>(m, n) array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spatial distribution of the slope, in degrees.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="k">def</span> <span class="nf">get_slope</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the slope (or inclination) of the terrain.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    dem : (m, n) array</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        2D array with the digital elevation model (DEM) of the area.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    cellsize : int, optional</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        Cell size of the raster representing the DEM. Units must be consistent</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        with the units of ``dem``. Its default value is 1.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    -------</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    slope : (m, n) array</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        Spatial distribution of the slope, in degrees.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="n">dzdy</span><span class="p">,</span> <span class="n">dzdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="n">dzdx</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Adequate sign for the x component</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dzdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dzdy</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.hzt_accel_from_2_dir" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">hzt_accel_from_2_dir</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hzt_accel_from_2_dir</span><span class="p">(</span><span class="n">accel_ew</span><span class="p">,</span> <span class="n">accel_ns</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the resultant acceleration from two horizontal components.</p>
<p>This funtion is optimized for speed using Numba.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>accel_ew</code></td>
          <td>
                <code>(n,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series in the East-West direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel_ns</code></td>
          <td>
                <code>(n,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series in the North-South direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>azimuth</code></td>
          <td>
                <code>float or int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Azimuth of the slope dip direction, in [°] and measured clockwise from
North.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>accel_hzt</code></td>          <td>
                <code>(n, ) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the resultant horizontal acceleration series.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="nd">@njit</span><span class="p">(</span><span class="n">fastmath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">def</span> <span class="nf">hzt_accel_from_2_dir</span><span class="p">(</span><span class="n">accel_ew</span><span class="p">,</span> <span class="n">accel_ns</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">):</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the resultant acceleration from two horizontal components.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    This funtion is optimized for speed using Numba.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    accel_ew : (n,) ndarray</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        1D array with the acceleration series in the East-West direction.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    accel_ns : (n,) ndarray</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        1D array with the acceleration series in the North-South direction.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    azimuth : float or int</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        Azimuth of the slope dip direction, in [°] and measured clockwise from</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        North.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    -------</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    accel_hzt : (n, ) ndarray</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        1D array with the resultant horizontal acceleration series.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">azimuth_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">return</span> <span class="n">accel_ew</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth_r</span><span class="p">)</span> <span class="o">+</span> <span class="n">accel_ns</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth_r</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.load_ascii_raster" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">load_ascii_raster</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">load_ascii_raster</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Load a raster file in ASCII format (<code>.ASC</code> extension).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>File to be loaded. It must be in <a href="https://en.wikipedia.org/wiki/Esri_grid">Esri ASCII raster format</a>.
Its header must be 6 lines long, and the spatial location of the raster
is specified by the location of the lower left corner of the lower
left cell, as shown below:</p>
<pre><code>NCOLS xxx
NROWS xxx
XLLCORNER xxx
YLLCORNER xxx
CELLSIZE xxx
NODATA_VALUE xxx
row 1
row 2
...
row n
</code></pre>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>data-type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data type of the returned array. If not given (i.e., <code>dtype=None</code>), the
data type is determined by the contents of the file. Its default value
is <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>raster</code></td>          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raster data given as a 2D array.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>header</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Header of the raster file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">def</span> <span class="nf">load_ascii_raster</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a raster file in ASCII format (`.ASC` extension).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    path : str</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        File to be loaded. It must be in [Esri ASCII raster format](</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        https://en.wikipedia.org/wiki/Esri_grid).</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        Its header must be 6 lines long, and the spatial location of the raster</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        is specified by the location of the lower left corner of the lower</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        left cell, as shown below:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        ```</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            NCOLS xxx</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            NROWS xxx</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            XLLCORNER xxx</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            YLLCORNER xxx</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            CELLSIZE xxx</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            NODATA_VALUE xxx</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            row 1</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            row 2</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            ...</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            row n</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        ```</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    dtype : data-type, optional</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        Data type of the returned array. If not given (i.e., `dtype=None`), the</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        data type is determined by the contents of the file. Its default value</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        is `None`.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    -------</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    raster : (m, n) ndarray</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        Raster data given as a 2D array.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    header : dict</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        Header of the raster file.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">raster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">header</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="s2">&quot;ncols&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="s2">&quot;nrows&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="s2">&quot;xllcorner&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="s2">&quot;yllcorner&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="s2">&quot;cellsize&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="s2">&quot;nodata_value&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="p">}</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">raster</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">raster</span> <span class="o">==</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;nodata_value&quot;</span><span class="p">])]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">raster</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span> <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">raster</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.map_zones" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">map_zones</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">map_zones</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Associate geotechnical parameters to zones.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parameters</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the geotechnical parameters of each zone. The keys are
the zone numbers, and the values are tuples with the zone's friction
angle in [°], cohesion in [kPa], and unit weight in [kN/m³],
respectively.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>zones</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the zone number assigned to each cell. There has to be as
many zone numbers as keys in the parameters dictionary.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>phi, c, gamma : (m, n) ndarray, (m, n) ndarray, (m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Three 2D arrays with the spatial distribution of the friction angle,
cohesion, and unit weight, respectively. Each array has the same shape
as <code>zones</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span> <span class="nf">map_zones</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">zones</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Associate geotechnical parameters to zones.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    parameters : dict</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        Dictionary with the geotechnical parameters of each zone. The keys are</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        the zone numbers, and the values are tuples with the zone&#39;s friction</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        angle in [°], cohesion in [kPa], and unit weight in [kN/m³],</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        respectively.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    zones : (m, n) ndarray</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        2D array with the zone number assigned to each cell. There has to be as</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        many zone numbers as keys in the parameters dictionary.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    -------</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    phi, c, gamma : (m, n) ndarray, (m, n) ndarray, (m, n) ndarray</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        Three 2D arrays with the spatial distribution of the friction angle,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        cohesion, and unit weight, respectively. Each array has the same shape</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        as ``zones``.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># Zone: frict_angle, cohesion, gamma</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">phi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zones</span> <span class="o">==</span> <span class="n">z</span><span class="p">)]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">c</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zones</span> <span class="o">==</span> <span class="n">z</span><span class="p">)]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">gamma</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zones</span> <span class="o">==</span> <span class="n">z</span><span class="p">)]</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.plot_spatial_field" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">plot_spatial_field</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">plot_spatial_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Plot a spatial field.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>field</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial field to be plotted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dem</code></td>
          <td>
                <code>(m, n) ndarray or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the digital elevation model (DEM) of the area. It is used
to plot the hillshade below the spatial field to enhance the
visualization. By default its value is <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>discrete</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the spatial field is plotted as a discrete field. By
default its value is <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments. <code>spat_ref</code> is a dictionary with the
spatial reference of the raster. It contains the same information of
the ASCII file header. See the documentation of the <code>read_ascii</code>
function for more information. <code>levels</code> is a list or array with the
contour levels. <code>cmap</code> is a colormap palette accepted by
Matplotlib, or a <code>str</code> with the name of a Matplotlib colormap.
<code>label</code> is a list of <code>str</code> with the labels of the unique elements
in a discrete field. <code>vmin</code> and <code>vmax</code> define the data range that
the colormap covers. <code>labelrot</code> is the rotation angle of the colorbar
ticks labels. <code>title</code> is the title of the spatial field.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fig</code></td>          <td>
                <code>matplotlib.<span title="matplotlib.figure">figure</span>.<span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matplotlib object which might be used to save the figure as a file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="k">def</span> <span class="nf">plot_spatial_field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dem</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    Plot a spatial field.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    field : (m, n) ndarray</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        2D array with the spatial field to be plotted.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    dem : (m, n) ndarray or None, optional</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        2D array with the digital elevation model (DEM) of the area. It is used</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        to plot the hillshade below the spatial field to enhance the</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        visualization. By default its value is ``None``.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    discrete : bool, optional</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        If ``True``, the spatial field is plotted as a discrete field. By</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        default its value is ``False``.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    **kwargs : dict, optional</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Additional keyword arguments. ``spat_ref`` is a dictionary with the</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        spatial reference of the raster. It contains the same information of</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        the ASCII file header. See the documentation of the ``read_ascii``</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        function for more information. ``levels`` is a list or array with the</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        contour levels. ``cmap`` is a colormap palette accepted by</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Matplotlib, or a ``str`` with the name of a Matplotlib colormap.</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        ``label`` is a list of ``str`` with the labels of the unique elements</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        in a discrete field. ``vmin`` and ``vmax`` define the data range that</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        the colormap covers. ``labelrot`` is the rotation angle of the colorbar</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        ticks labels. ``title`` is the title of the spatial field.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    -------</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    fig : matplotlib.figure.Figure</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Matplotlib object which might be used to save the figure as a file.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">spat_ref</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="s2">&quot;spat_ref&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;xllcorner&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;yllcorner&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;cellsize&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;xllcorner&quot;</span><span class="p">],</span>  <span class="c1"># x min</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;xllcorner&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;cellsize&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>  <span class="c1"># x max</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;yllcorner&quot;</span><span class="p">],</span>  <span class="c1"># y min</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;yllcorner&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;cellsize&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span>  <span class="c1"># y max</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="k">if</span> <span class="n">dem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Generate hillshade in background and contours</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># Transparency for ploting the field over the hillshade</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="n">hsd</span> <span class="o">=</span> <span class="n">get_hillshade</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="n">spat_ref</span><span class="p">[</span><span class="s2">&quot;cellsize&quot;</span><span class="p">])</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">hsd</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="c1"># ax.matshow(dem, cmap=&quot;gray&quot;, extent=extent, alpha=alpha)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="n">levels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;levels&quot;</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="n">dem</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">if</span> <span class="n">discrete</span><span class="p">:</span>  <span class="c1"># Plot field as a discrete variable with unique values</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">field</span><span class="p">)[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">field</span><span class="p">))]</span>  <span class="c1"># For colorbar</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="n">field_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>  <span class="c1"># Empty reclasified field</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">ticks_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Ticks to use in reclasified field</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ticks_r</span><span class="p">:</span>  <span class="c1">#  Fill reclasified field</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">field_r</span><span class="p">[</span><span class="n">field</span> <span class="o">==</span> <span class="n">ticks</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">field_r</span><span class="p">,</span>  <span class="c1"># plots the reclasified field instead of the original</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">vmax</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="p">)</span>  <span class="c1"># map reclasified, but use the original labels</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks_r</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">ticks</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="k">else</span> <span class="n">ticks</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Plot field as a continue variable</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">vmin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">vmax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">field_isfin</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">field</span><span class="p">)]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">field_isfin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">vmin</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">field_isfin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">extend</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">field_isfin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">vmin</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="n">extend</span> <span class="o">=</span> <span class="s2">&quot;min&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">field_isfin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">extend</span> <span class="o">=</span> <span class="s2">&quot;max&quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="n">extend</span> <span class="o">=</span> <span class="s2">&quot;neither&quot;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">field</span><span class="p">,</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">vmin</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">),</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">vmax</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">),</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="c1"># Colorbar settings</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">lr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labelrot&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Scale&quot;</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">set_va</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="c1"># Axis settings</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">set_va</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()]</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.reclass_raster" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">reclass_raster</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">reclass_raster</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">limits</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Reclassify a raster based on a list of limits.</p>
<p>Convert a continuous raster into a categorical one. The limits are used to
define the categories.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>field</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial field to be reclassified.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>limits</code></td>
          <td>
                <code>array_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Limits to be used in the reclassification. The minimum and maximum
values of the field should <em>not</em> be included as the first and last
elements of the list, as they are automatically included in the limits.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field_reclass</code></td>          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the reclassified field.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="k">def</span> <span class="nf">reclass_raster</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">limits</span><span class="p">):</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reclassify a raster based on a list of limits.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    Convert a continuous raster into a categorical one. The limits are used to</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    define the categories.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    field : (m, n) ndarray</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        2D array with the spatial field to be reclassified.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    limits : array_like</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        Limits to be used in the reclassification. The minimum and maximum</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        values of the field should *not* be included as the first and last</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        elements of the list, as they are automatically included in the limits.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    -------</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    field_reclass : (m, n) ndarray</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">        2D array with the reclassified field.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="n">limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">limits</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">field</span><span class="p">)))</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="n">field_reclass</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lim</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">limits</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">field_reclass</span><span class="p">[</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">field</span> <span class="o">&gt;=</span> <span class="n">limits</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">field</span> <span class="o">&lt;=</span> <span class="n">limits</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">return</span> <span class="n">field_reclass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.spatial_hzt_accel_from_2_dir" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">spatial_hzt_accel_from_2_dir</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">spatial_hzt_accel_from_2_dir</span><span class="p">(</span><span class="n">accel_ew</span><span class="p">,</span> <span class="n">accel_ns</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate spatially the resultant acceleration from two hztl components.</p>
<p>The azimuth is spatially distributed (e.g., obtained using the
<code>get_dip_azimuth</code> function), but <code>accel_ew</code>, <code>accel_ns</code>, and
<code>time_vect</code> are constant over all the spatial domain.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>accel_ew</code></td>
          <td>
                <code>(p,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series in the East-West direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel_ns</code></td>
          <td>
                <code>(p,) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D array with the acceleration series in the North-South direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>azimuth</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the azimuth of the slope dip
direction, in [°] and measured clockwise from North.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>accel_hzt</code></td>          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the resultant horizontal acceleration series calculated
at each cell. There is a 1D array with the resultant horizontal
acceleration series at each cell (i, j).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="k">def</span> <span class="nf">spatial_hzt_accel_from_2_dir</span><span class="p">(</span><span class="n">accel_ew</span><span class="p">,</span> <span class="n">accel_ns</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">):</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate spatially the resultant acceleration from two hztl components.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    The azimuth is spatially distributed (e.g., obtained using the</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    ``get_dip_azimuth`` function), but ``accel_ew``, ``accel_ns``, and</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    ``time_vect`` are constant over all the spatial domain.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    accel_ew : (p,) ndarray</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        1D array with the acceleration series in the East-West direction.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    accel_ns : (p,) ndarray</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        1D array with the acceleration series in the North-South direction.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    azimuth : (m, n) ndarray</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        2D array with the spatial distribution of the azimuth of the slope dip</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        direction, in [°] and measured clockwise from North.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    -------</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    accel_hzt : (m, n) ndarray</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        2D array with the resultant horizontal acceleration series calculated</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        at each cell. There is a 1D array with the resultant horizontal</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        acceleration series at each cell (i, j).</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">azimuth</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">azimuth_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">accel_hzt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">azimuth_r</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">col</span><span class="p">)):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">accel_hzt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hzt_accel_from_2_dir</span><span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">accel_ew</span><span class="p">,</span> <span class="n">accel_ns</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">return</span> <span class="n">accel_hzt</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.spatial_newmark" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">spatial_newmark</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">spatial_newmark</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the spatial distribution of permanent displacements.</p>
<p>Perform the direct Newmarkl method for each cell of the spatial domain and
return the spatial distribution of the permanent displacements.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D or 2D array with the time data, in [s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel</code></td>
          <td>
                <code>tuple, list or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object with the acceleration data. If it <code>azimuth</code> is given,
<code>accel</code> must have a length of 2 and contain the acceleration in the
East-West and North-South directions, respectively; both components of
the acceleration might be constant or spatially distributed. If
<code>azimuth</code> is <code>None</code>, the <code>accel</code> vector might be spatially
distributed (2D array) or constant (1D array).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ky</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the critical seismic
coefficient.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>g</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Acceleration of gravity, in the same units as <code>accel</code>. For example,
if <code>accel</code> is in [m/s²], <code>g</code> should be equal to 9.81; if <code>accel</code>
is as a fraction of gravity, <code>g</code> should be equal to 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>azimuth</code></td>
          <td>
                <code>(m, n) ndarray or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the azimuth of the slope dip
direction, in [°] and measured clockwise from North. By default its
value is <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>permanent_disp</code></td>          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of permanent displacements.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span> <span class="nf">spatial_newmark</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the spatial distribution of permanent displacements.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Perform the direct Newmarkl method for each cell of the spatial domain and</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    return the spatial distribution of the permanent displacements.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    time : ndarray</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        1D or 2D array with the time data, in [s].</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    accel : tuple, list or ndarray</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        Object with the acceleration data. If it ``azimuth`` is given,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        ``accel`` must have a length of 2 and contain the acceleration in the</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        East-West and North-South directions, respectively; both components of</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        the acceleration might be constant or spatially distributed. If</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        ``azimuth`` is ``None``, the ``accel`` vector might be spatially</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        distributed (2D array) or constant (1D array).</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    ky : ndarray</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        2D array with the spatial distribution of the critical seismic</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        coefficient.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    g : float</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        Acceleration of gravity, in the same units as ``accel``. For example,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        if ``accel`` is in [m/s²], ``g`` should be equal to 9.81; if ``accel``</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        is as a fraction of gravity, ``g`` should be equal to 1.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    azimuth : (m, n) ndarray or None, optional</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        2D array with the spatial distribution of the azimuth of the slope dip</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        direction, in [°] and measured clockwise from North. By default its</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        value is ``None``.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    -------</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    permanent_disp : (m, n) ndarray</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        2D array with the spatial distribution of permanent displacements.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">ky</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">ky</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">ky</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">permanent_disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ky</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">col</span><span class="p">)):</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="k">continue</span>  <span class="c1"># Skip step and continue the loop as u_p=np.nan</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">time_s</span><span class="p">,</span> <span class="n">accel_s</span> <span class="o">=</span> <span class="n">_select_case</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">newmark_str</span> <span class="o">=</span> <span class="n">direct_newmark</span><span class="p">(</span><span class="n">time_s</span><span class="p">,</span> <span class="n">accel_s</span><span class="p">,</span> <span class="n">ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">permanent_disp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;perm_disp&quot;</span><span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">permanent_disp</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.spatial.verify_newmark_at_cell" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">verify_newmark_at_cell</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">verify_newmark_at_cell</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Verify the direct Newmark method at a specific cell.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cell</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple with the index of the cell to be verified.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>1D or 2D array with the time data, in [s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>accel</code></td>
          <td>
                <code>tuple or list or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object with the acceleration data. If it <code>azimuth</code> is given,
<code>accel</code> must have a length of 2 and contain the acceleration in the
East-West and North-South directions, respectively; both components of
the acceleration might be constant or spatially distributed. If
<code>azimuth</code> is <code>None</code>, the <code>accel</code> vector might be spatially
distributed (2D array) or constant (1D array).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>g</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Acceleration of gravity, in the same units as <code>accel</code>. For example,
if <code>accel</code> is in [m/s²], <code>g</code> should be equal to 9.81; if <code>accel</code>
is as a fraction of gravity, <code>g</code> should be equal to 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>depth</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the potential sliding surface
depth, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>depth_w</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the water table depth, in
[m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>slope</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the slope inclination, in
[°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phi</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the internal friction angle,
in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>(m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the cohesion, in [kPa].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gamma</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the soil unit weight, in
[kN/m³].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>azimuth</code></td>
          <td>
                <code>(m, n) ndarray or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with the spatial distribution of the azimuth of the slope dip
direction, in [°] and measured clockwise from North. By default its
value is <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>newmark_str</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the results of the direct Newmark method at the cell.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/spatial.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">def</span> <span class="nf">verify_newmark_at_cell</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="p">):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify the direct Newmark method at a specific cell.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    cell : tuple</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        Tuple with the index of the cell to be verified.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    time : ndarray</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        1D or 2D array with the time data, in [s].</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    accel : tuple or list or ndarray</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        Object with the acceleration data. If it ``azimuth`` is given,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        ``accel`` must have a length of 2 and contain the acceleration in the</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        East-West and North-South directions, respectively; both components of</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        the acceleration might be constant or spatially distributed. If</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        ``azimuth`` is ``None``, the ``accel`` vector might be spatially</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        distributed (2D array) or constant (1D array).</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    g : float</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Acceleration of gravity, in the same units as ``accel``. For example,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        if ``accel`` is in [m/s²], ``g`` should be equal to 9.81; if ``accel``</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        is as a fraction of gravity, ``g`` should be equal to 1.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    depth : (m, n) ndarray</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        2D array with the spatial distribution of the potential sliding surface</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        depth, in [m].</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    depth_w : ndarray</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        2D array with the spatial distribution of the water table depth, in</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        [m].</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    slope : (m, n) ndarray</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        2D array with the spatial distribution of the slope inclination, in</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        [°].</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    phi : (m, n) ndarray</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        2D array with the spatial distribution of the internal friction angle,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        in [°].</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    c : (m, n) ndarray</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        2D array with the spatial distribution of the cohesion, in [kPa].</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    gamma : ndarray</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        2D array with the spatial distribution of the soil unit weight, in</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        [kN/m³].</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    azimuth : (m, n) ndarray or None, optional</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        2D array with the spatial distribution of the azimuth of the slope dip</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        direction, in [°] and measured clockwise from North. By default its</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        value is ``None``.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    -------</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    newmark_str : dict</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Dictionary with the results of the direct Newmark method at the cell.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cell</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="n">depth</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">depth_w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">slope</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">fs_static</span> <span class="o">=</span> <span class="n">factor_of_safety</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">ky</span> <span class="o">=</span> <span class="n">get_ky</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">fs_ky</span> <span class="o">=</span> <span class="n">factor_of_safety</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ky</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">time_s</span><span class="p">,</span> <span class="n">accel_s</span> <span class="o">=</span> <span class="n">_select_case</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">time</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">newmark_str</span> <span class="o">=</span> <span class="n">direct_newmark</span><span class="p">(</span><span class="n">time_s</span><span class="p">,</span> <span class="n">accel_s</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;fs_static&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fs_static</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">newmark_str</span><span class="p">[</span><span class="s2">&quot;fs_ky&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fs_ky</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">return</span> <span class="n">newmark_str</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="pynewmarkdisp.infslope" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">pynewmarkdisp.infslope</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Functions to calculate the factor of safety of an infinite slope mechanism.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.infslope.factor_of_safety" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">factor_of_safety</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">factor_of_safety</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the factor of safety for an infinite slope mechanism.</p>
<p>Inputs can be either constant or spatially distributed variables.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>depth</code></td>
          <td>
                <code>float or (m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the planar suface, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>depth_w</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the watertable, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>slope</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phi</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cohesion, in [kPa].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gamma</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Average unit weigth of the soil, in [kN/m³].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ks</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seismic coefficient for pseudostatic analysis. Its default value is
<code>0</code>, meaning that the analysis is static (no seismic force included).</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fs</code></td>          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Factor of safety</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/infslope.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="k">def</span> <span class="nf">factor_of_safety</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the factor of safety for an infinite slope mechanism.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Inputs can be either constant or spatially distributed variables.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    depth : float or (m, n) ndarray</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        Depth of the planar suface, in [m].</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    depth_w : float or ndarray</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        Depth of the watertable, in [m].</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    slope : float or ndarray</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    phi : float or ndarray</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    c : float or ndarray</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        Cohesion, in [kPa].</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    gamma : float or ndarray</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        Average unit weigth of the soil, in [kN/m³].</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    ks : float or ndarray</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        Seismic coefficient for pseudostatic analysis. Its default value is</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        ``0``, meaning that the analysis is static (no seismic force included).</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    -------</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    fs : float or ndarray</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        Factor of safety</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">depth</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">depth_w</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">depth_w</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">slope</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">slope</span><span class="p">))</span>  <span class="c1"># Slope angle to radians</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>  <span class="c1"># Friction angle to radians</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1"># Calculation</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="c1"># depth[np.where(depth == 0)] = np.nan  # Slice height cannot be zero</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">head_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">depth_w</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">head_pressure</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">depth_w</span> <span class="o">&gt;</span> <span class="n">depth</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Watertable below slip surf.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">pw</span> <span class="o">=</span> <span class="n">head_pressure</span> <span class="o">*</span> <span class="mf">9.81</span>  <span class="c1"># kN; Hydrostatic force</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">w</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>  <span class="c1"># kPa; Weight of sliding mass</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">tau</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">-</span> <span class="n">ks</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">))</span> <span class="o">-</span> <span class="n">pw</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">slip_force</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">+</span> <span class="n">ks</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">))</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1"># slip_force[np.where(beta == 0)] = 0.001  # ~zero for horizontal surfaces</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">slip_force</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">fs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fs</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Factor of safety restricted to max. 3</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">if</span> <span class="n">fs</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.infslope.get_ky" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_ky</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_ky</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Compute the critical seismic coefficient of an infinite slope mechanism.</p>
<p>Inputs can be either constant or spatially distributed variables.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>depth</code></td>
          <td>
                <code>float or (m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the planar suface, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>depth_w</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the watertable, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>slope</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phi</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cohesion, in [kPa].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gamma</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Average unit weigth of the soil, in [kN/m³].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ky</code></td>          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical seismic coefficient.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/infslope.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="k">def</span> <span class="nf">get_ky</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the critical seismic coefficient of an infinite slope mechanism.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Inputs can be either constant or spatially distributed variables.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    depth : float or (m, n) ndarray</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Depth of the planar suface, in [m].</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    depth_w : float or ndarray</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Depth of the watertable, in [m].</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    slope : float or ndarray</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    phi : float or ndarray</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    c : float or ndarray</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        Cohesion, in [kPa].</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    gamma : float or ndarray</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Average unit weigth of the soil, in [kN/m³].</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    -------</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    ky : float or ndarray</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Critical seismic coefficient.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">depth</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">depth_w</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">depth_w</span><span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>  <span class="c1"># Slope angle to radians</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>  <span class="c1"># Friction angle to radians</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="c1"># Intermediate calculations</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="c1"># depth[np.where(depth == 0)] = np.nan  # Slice height cannot be zero</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">head_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">depth_w</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">pw</span> <span class="o">=</span> <span class="n">head_pressure</span> <span class="o">*</span> <span class="mf">9.81</span>  <span class="c1"># kN; Hydrostatic force</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">w</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>  <span class="c1"># kPa; Weight of sliding mass</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># Ky calculation</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1"># num = np.divide(np.cos(beta) - pw, w) * np.divide(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="c1">#     np.tan(phi) + c, w</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="c1"># ) - np.sin(beta)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">w</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.001</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">-</span> <span class="n">pw</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span> <span class="o">/</span> <span class="n">w</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">ky</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="c1"># ky = num / den</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">ky</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ky</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># The slope is stable under pseudo-static cond.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">ky</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ky</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># The slope is unstable under static cond.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="c1"># ky[np.where(ky &gt; 1)] = 1  # The slope is stable under sedudostatic cond.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">if</span> <span class="n">ky</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">ky</span> <span class="o">=</span> <span class="n">ky</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ky</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.infslope.min_fs_and_depth" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">min_fs_and_depth</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">min_fs_and_depth</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nd</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the minimum factor of safety and the depth at which it occurs.</p>
<p>As for the <code>factor_of_safety</code> function, inputs can be either constant or
spatially distributed variables.</p>
<p>It evaluates the factor of safety for a range of <code>nd</code> depths between the
terrain surface and the slip surface and return the minimum factor of
safety and the depth at which it occurs. This is useful to find the
critical slip surface, which will be located at the first depth where the
factor of safety drops below 1 or where it reaches its minimum value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>depth</code></td>
          <td>
                <code>float or (m, n) ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the planar suface, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>depth_w</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth of the watertable, in [m].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>slope</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phi</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Slope inclination, in [°].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cohesion, in [kPa].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gamma</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Average unit weigth of the soil, in [kN/m³].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ks</code></td>
          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seismic coefficient for pseudostatic analysis. Its default value is
<code>0</code>, meaning that the analysis is static (no seismic force included).</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>nd</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of depths to evaluate between the terrain surface and the slip
surface. The default is <code>10</code>.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>min_fs</code></td>          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum factor of safety</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>depth_at_min_fs</code></td>          <td>
                <code>float or ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Depth at which the minimum factor of safety occurs, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/infslope.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">def</span> <span class="nf">min_fs_and_depth</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nd</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the minimum factor of safety and the depth at which it occurs.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    As for the ``factor_of_safety`` function, inputs can be either constant or</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    spatially distributed variables.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    It evaluates the factor of safety for a range of ``nd`` depths between the</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    terrain surface and the slip surface and return the minimum factor of</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    safety and the depth at which it occurs. This is useful to find the</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    critical slip surface, which will be located at the first depth where the</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    factor of safety drops below 1 or where it reaches its minimum value.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    depth : float or (m, n) ndarray</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Depth of the planar suface, in [m].</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    depth_w : float or ndarray</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        Depth of the watertable, in [m].</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    slope : float or ndarray</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    phi : float or ndarray</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Slope inclination, in [°].</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    c : float or ndarray</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Cohesion, in [kPa].</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    gamma : float or ndarray</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        Average unit weigth of the soil, in [kN/m³].</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    ks : float or ndarray</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        Seismic coefficient for pseudostatic analysis. Its default value is</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        ``0``, meaning that the analysis is static (no seismic force included).</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    nd : int, optional</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        Number of depths to evaluate between the terrain surface and the slip</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        surface. The default is ``10``.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    -------</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    min_fs : float or ndarray</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        Minimum factor of safety</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    depth_at_min_fs : float or ndarray</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        Depth at which the minimum factor of safety occurs, in [m].</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">depth</span> <span class="o">=</span> <span class="n">num_to_2darray</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># depth[np.where(depth == 0)] = np.nan  # Slice height cannot be zero</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">min_fs</span> <span class="o">=</span> <span class="n">factor_of_safety</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">depth_at_min_fs</span> <span class="o">=</span> <span class="n">depth</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">for</span> <span class="n">ith_depth_fract</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nd</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">ith_depth</span> <span class="o">=</span> <span class="n">ith_depth_fract</span> <span class="o">*</span> <span class="n">depth</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">ith_fs</span> <span class="o">=</span> <span class="n">factor_of_safety</span><span class="p">(</span><span class="n">ith_depth</span><span class="p">,</span> <span class="n">depth_w</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ks</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ith_fs</span> <span class="o">&lt;</span> <span class="n">min_fs</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">min_fs</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ith_fs</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">depth_at_min_fs</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ith_depth</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">return</span> <span class="n">min_fs</span><span class="p">,</span> <span class="n">depth_at_min_fs</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.infslope.num_to_2darray" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">num_to_2darray</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">num_to_2darray</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Turn an int or float input into a 2D array with shape (1, 1).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Variable to be converted to a 2D array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>num_array</code></td>          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array with shape (1, 1) whose only element is the input variable.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/infslope.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">def</span> <span class="nf">num_to_2darray</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Turn an int or float input into a 2D array with shape (1, 1).</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    num : int or float</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        Variable to be converted to a 2D array</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    -------</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    num_array : ndarray</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        2D array with shape (1, 1) whose only element is the input variable.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="n">num</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="pynewmarkdisp.empir_corr" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">pynewmarkdisp.empir_corr</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Functions to calculate permanent displacements from empirical correlations.</p>
<p>Most of the functions in this module are taken from Table 1 in
<a href="https://doi.org/10.1016/j.enggeo.2012.10.016">Meehan &amp; Vahedifard (2013)</a>,
who compiled a several empirical correlations or simplified methods for
calculating the permanent displacement of a slope. The keys of the
<code>correlations</code> dictionary are the same as the numbering of the cited table.
However, additional functions were added to the dictionary after consulting
the original references.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.ambraseys_and_menu_88" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">ambraseys_and_menu_88</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ambraseys_and_menu_88</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Ambraseys and Menu (1988) empirical correlation for uₚ.</p>
<p>Eq. 10 in Meehan &amp; Vahedifard (2013).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span> <span class="nf">ambraseys_and_menu_88</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ambraseys and Menu (1988) empirical correlation for uₚ.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Eq. 10 in Meehan &amp; Vahedifard (2013).</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    -------</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mf">0.90</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">car</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.53</span> <span class="o">*</span> <span class="n">car</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.09</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.bray_and_travasarou_07_eq6" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">bray_and_travasarou_07_eq6</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bray_and_travasarou_07_eq6</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Bray and Travasarou (2007) empirical correlation for uₚ.</p>
<p>Eq. 10 in Meehan &amp; Vahedifard (2013). Eq. 6 in Bray and Travasarou (2007).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>magnitude</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Earthquake magnitude.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">def</span> <span class="nf">bray_and_travasarou_07_eq6</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Bray and Travasarou (2007) empirical correlation for uₚ.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Eq. 10 in Meehan &amp; Vahedifard (2013). Eq. 6 in Bray and Travasarou (2007).</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    magnitude : float</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        Earthquake magnitude.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    -------</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="o">-</span><span class="mf">0.22</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="o">-</span> <span class="mf">2.83</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ay</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="o">-</span> <span class="mf">0.333</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ay</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="o">+</span> <span class="mf">0.566</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ay</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="o">+</span> <span class="mf">3.04</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="o">-</span> <span class="mf">0.244</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="o">+</span> <span class="mf">0.278</span> <span class="o">*</span> <span class="p">(</span><span class="n">magnitude</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_mean" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">hynesgriffin_and_Franklin_1984_mean</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hynesgriffin_and_Franklin_1984_mean</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Hynes-Griffin and Franklin (1984) empirical correlation for uₚ (mean).</p>
<p>Eq. 8 in Meehan &amp; Vahedifard (2013). It is a functional form of the mean
resulting from regression analysis of chart-based solution from the
original paper.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="k">def</span> <span class="nf">hynesgriffin_and_Franklin_1984_mean</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Hynes-Griffin and Franklin (1984) empirical correlation for uₚ (mean).</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Eq. 8 in Meehan &amp; Vahedifard (2013). It is a functional form of the mean</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    resulting from regression analysis of chart-based solution from the</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    original paper.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    -------</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="o">-</span><span class="mf">0.287</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="o">-</span> <span class="mf">2.854</span> <span class="o">*</span> <span class="n">car</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="o">-</span> <span class="mf">1.733</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="o">-</span> <span class="mf">0.702</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="o">-</span> <span class="mf">0.116</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">4</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.hynesgriffin_and_Franklin_1984_ub" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">hynesgriffin_and_Franklin_1984_ub</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hynesgriffin_and_Franklin_1984_ub</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Hynes-Griffin and Franklin (1984) empirical corr. for uₚ (upper bound).</p>
<p>Eq. 7 in Meehan &amp; Vahedifard (2013). It is a functional form of the upper
bound resulting from regression analysis of chart-based solution from the
original paper.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">def</span> <span class="nf">hynesgriffin_and_Franklin_1984_ub</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Hynes-Griffin and Franklin (1984) empirical corr. for uₚ (upper bound).</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Eq. 7 in Meehan &amp; Vahedifard (2013). It is a functional form of the upper</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    bound resulting from regression analysis of chart-based solution from the</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    original paper.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    -------</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="mf">0.804</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="o">-</span> <span class="mf">1.847</span> <span class="o">*</span> <span class="n">car</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="o">-</span> <span class="mf">0.285</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="o">+</span> <span class="mf">0.193</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="o">+</span> <span class="mf">0.078</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">4</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.jibson_07_eq10" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">jibson_07_eq10</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">jibson_07_eq10</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Jibson (2007) empirical correlation for uₚ.</p>
<p>Eq. 19 in Meehan &amp; Vahedifard (2013). Eq. 10 in Jibson (2007).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>arias_int</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arias intensity, in [m/s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span> <span class="nf">jibson_07_eq10</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Jibson (2007) empirical correlation for uₚ.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Eq. 19 in Meehan &amp; Vahedifard (2013). Eq. 10 in Jibson (2007).</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    arias_int : float</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Arias intensity, in [m/s].</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    -------</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="mf">0.561</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">arias_int</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.833</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">car</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.474</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.jibson_07_eq6" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">jibson_07_eq6</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">jibson_07_eq6</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Jibson (2007) empirical correlation for uₚ.</p>
<p>Eq. 16 in Meehan &amp; Vahedifard (2013). Eq. 6 in Jibson (2007).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="k">def</span> <span class="nf">jibson_07_eq6</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Jibson (2007) empirical correlation for uₚ.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Eq. 16 in Meehan &amp; Vahedifard (2013). Eq. 6 in Jibson (2007).</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    -------</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.215</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.341</span> <span class="o">*</span> <span class="n">car</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.438</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.jibson_07_eq9" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">jibson_07_eq9</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">jibson_07_eq9</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Jibson (2007) empirical correlation for uₚ.</p>
<p>Eq. 18 in Meehan &amp; Vahedifard (2013). Eq. 9 in Jibson (2007).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>arias_int</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arias intensity, in [m/s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="k">def</span> <span class="nf">jibson_07_eq9</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Jibson (2007) empirical correlation for uₚ.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Eq. 18 in Meehan &amp; Vahedifard (2013). Eq. 9 in Jibson (2007).</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    arias_int : float</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Arias intensity, in [m/s].</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    -------</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="mf">2.401</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">arias_int</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.481</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ay</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.23</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq5" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">saygili_and_rathje_08_eq5</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">saygili_and_rathje_08_eq5</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Saygili and Rathje (2008) empirical correlation for uₚ.</p>
<p>Eq. 20 in Meehan &amp; Vahedifard (2013). Eq. 5 in Saygili and Rathje (2008).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="k">def</span> <span class="nf">saygili_and_rathje_08_eq5</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saygili and Rathje (2008) empirical correlation for uₚ.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    Eq. 20 in Meehan &amp; Vahedifard (2013). Eq. 5 in Saygili and Rathje (2008).</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    -------</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="mf">5.52</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="o">-</span> <span class="mf">4.43</span> <span class="o">*</span> <span class="n">car</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="o">-</span> <span class="mf">20.93</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="o">+</span> <span class="mf">42.61</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="o">-</span> <span class="mf">28.74</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">4</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="o">+</span> <span class="mf">0.72</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col2" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">saygili_and_rathje_08_eq6col2</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">saygili_and_rathje_08_eq6col2</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">v_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Saygili and Rathje (2008) empirical correlation for uₚ.</p>
<p>Eq. 21 in Meehan &amp; Vahedifard (2013). Eq. 6 in Saygili and Rathje (2008)
with parameters from Table 1, column 2.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>v_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground velocity, in [cm/s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="k">def</span> <span class="nf">saygili_and_rathje_08_eq6col2</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">v_max</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saygili and Rathje (2008) empirical correlation for uₚ.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    Eq. 21 in Meehan &amp; Vahedifard (2013). Eq. 6 in Saygili and Rathje (2008)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    with parameters from Table 1, column 2.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    v_max : float</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Peak horizontal ground velocity, in [cm/s].</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    -------</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="o">-</span><span class="mf">1.56</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="o">-</span> <span class="mf">4.58</span> <span class="o">*</span> <span class="n">car</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="o">-</span> <span class="mf">20.84</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="o">+</span> <span class="mf">44.75</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="o">-</span> <span class="mf">30.5</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">4</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="o">-</span> <span class="mf">0.64</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="o">+</span> <span class="mf">1.55</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">v_max</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynewmarkdisp.empir_corr.saygili_and_rathje_08_eq6col4" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">saygili_and_rathje_08_eq6col4</span>


</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">saygili_and_rathje_08_eq6col4</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Saygili and Rathje (2008) empirical correlation for uₚ.</p>
<p>Not in Meehan &amp; Vahedifard (2013), but it is equivalent to Eq. 21.
Eq. 6 in Saygili and Rathje (2008) with parameters from Table 1, column 4.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ay</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Critical acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>a_max</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Peak horizontal ground acceleration, in fraction of g.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>arias_int</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arias intensity, in [m/s].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>perm_disp</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Permanent displacement, in [m].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynewmarkdisp/empir_corr.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="k">def</span> <span class="nf">saygili_and_rathje_08_eq6col4</span><span class="p">(</span><span class="n">ay</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">arias_int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saygili and Rathje (2008) empirical correlation for uₚ.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    Not in Meehan &amp; Vahedifard (2013), but it is equivalent to Eq. 21.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    Eq. 6 in Saygili and Rathje (2008) with parameters from Table 1, column 4.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    ay : float</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        Critical acceleration, in fraction of g.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    a_max : float</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        Peak horizontal ground acceleration, in fraction of g.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    arias_int : float</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        Arias intensity, in [m/s].</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    -------</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    perm_disp : float</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        Permanent displacement, in [m].</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="c1"># ay[np.where(ay &gt; a_max)] = a_max  # There is no excess acceleration</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">car</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">/</span> <span class="n">a_max</span>  <span class="c1"># Critical acceleration ratio</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="k">return</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="mf">2.39</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="o">-</span> <span class="mf">5.24</span> <span class="o">*</span> <span class="n">car</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="o">-</span> <span class="mf">18.78</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="o">+</span> <span class="mf">42.01</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">3</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="o">-</span> <span class="mf">29.15</span> <span class="o">*</span> <span class="n">car</span><span class="o">**</span><span class="mi">4</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="o">-</span> <span class="mf">1.56</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="o">+</span> <span class="mf">1.38</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arias_int</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Exneyder A. Montoya-Araque
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "content.code.copy"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>